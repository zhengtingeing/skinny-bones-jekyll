(function(){
/*! BEGIN MscorlibSlim */
var global=window;(function(global){"use strict";var ss={};ss.initAssembly=function(obj,name,res){};ss.isNullOrUndefined=function ss$isNullOrUndefined(o){return(o===null)||(o===undefined)};ss.isValue=function ss$isValue(o){return(o!==null)&&(o!==undefined)};ss.referenceEquals=function ss$referenceEquals(a,b){return ss.isValue(a)?a===b:!ss.isValue(b)};ss.mkdict=function ss$mkdict(){var a=(arguments.length!=1?arguments:arguments[0]);var r={};for(var i=0;i<a.length;i+=2){r[a[i]]=a[i+1]}return r};ss.clone=function ss$clone(t,o){return o?t.$clone(o):o};ss.coalesce=function ss$coalesce(a,b){return ss.isValue(a)?a:b};ss.isDate=function ss$isDate(obj){return Object.prototype.toString.call(obj)==='[object Date]'};ss.isArray=function ss$isArray(obj){return Object.prototype.toString.call(obj)==='[object Array]'};ss.equals=function ss$equals(a,b){if(!ss.isValue(a))throw new ss_NullReferenceException('Object is null');else if(a!==ss&&typeof(a.equals)==='function')return a.equals(b);if(ss.isDate(a)&&ss.isDate(b))return a.valueOf()===b.valueOf();else if(typeof(a)==='function'&&typeof(b)==='function')return ss.delegateEquals(a,b);else if(ss.isNullOrUndefined(a)&&ss.isNullOrUndefined(b))return true;else return a===b};ss.staticEquals=function ss$staticEquals(a,b){if(!ss.isValue(a))return!ss.isValue(b);else return ss.isValue(b)?ss.equals(a,b):false};ss.shallowCopy=function ss$shallowCopy(source,target){var keys=Object.keys(source);for(var i=0,l=keys.length;i<l;i++){var k=keys[i];target[k]=source[k]}};ss.clearKeys=function ss$clearKeys(d){for(var n in d){if(d.hasOwnProperty(n))delete d[n]}};ss.keyExists=function ss$keyExists(d,key){return d[key]!==undefined};if(!Object.keys){Object.keys=(function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='object'&&(typeof obj!=='function'||obj===null)){throw new TypeError('Object.keys called on non-object')}var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop)}}if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i])}}}return result}}())}ss.getKeyCount=function ss$getKeyCount(d){return Object.keys(d).length};ss.setMetadata=function ss$_setMetadata(type,metadata){};ss.initClass=function ss$initClass(ctor,asm,members,baseType,interfaces){if(baseType&&baseType!==Object){var f=function(){};f.prototype=baseType.prototype;ctor.prototype=new f;ctor.prototype.constructor=ctor}ss.shallowCopy(members,ctor.prototype)};ss.initEnum=function ss$initEnum(ctor,asm,members,namedValues){ss.shallowCopy(members,ctor.prototype);ctor.getDefaultValue=ctor.createInstance=function(){return namedValues?null:0};ctor.isInstanceOfType=function(instance){return typeof(instance)==(namedValues?'string':'number')}};ss.getBaseType=function ss$getBaseType(type){throw new Error("Not implemented yet")};ss.isInstanceOfType=function ss$isInstanceOfType(instance,type){if(ss.isNullOrUndefined(instance))return false;if(typeof(type.isInstanceOfType)==='function')return type.isInstanceOfType(instance);return ss.isAssignableFrom(type,ss.getInstanceType(instance))};ss.isAssignableFrom=function ss$isAssignableFrom(target,type){return target===type||(typeof(target.isAssignableFrom)==='function'&&target.isAssignableFrom(type))||type.prototype instanceof target};ss.safeCast=function ss$safeCast(instance,type){if(type===true)return instance;else if(type===false)return null;else return ss.isInstanceOfType(instance,type)?instance:null};ss.cast=function ss$cast(instance,type){if(instance===null||typeof(instance)==='undefined')return instance;else if(type===true||(type!==false&&ss.isInstanceOfType(instance,type)))return instance;throw new ss_InvalidCastException('Cannot cast object to requested type')};ss.getInstanceType=function ss$getInstanceType(instance){if(!ss.isValue(instance))throw new ss_NullReferenceException('Cannot get type of null');try{return instance.constructor}catch(ex){return Object}};ss.getDefaultValue=function ss$getDefaultValue(type){if(typeof(type.getDefaultValue)==='function')return type.getDefaultValue();else if(type===Boolean)return false;else if(type===Date)return new Date(0);else if(type===Number)return 0;return null};var ss_IFormattable=null;var ss_IComparable=null;var ss_IEquatable=null;ss.isNullOrEmptyString=function ss$isNullOrEmptyString(s){return!s||!s.length};if(!String.prototype.trim){String.prototype.trim=function String$trim(){return ss.trimStartString(ss.trimEndString(this))}}ss.trimEndString=function ss$trimEndString(s,chars){return s.replace(chars?new RegExp('['+String.fromCharCode.apply(null,chars)+']+$'):/\s*$/,'')};ss.trimStartString=function ss$trimStartString(s,chars){return s.replace(chars?new RegExp('^['+String.fromCharCode.apply(null,chars)+']+'):/^\s*/,'')};ss.trimString=function ss$trimString(s,chars){return ss.trimStartString(ss.trimEndString(s,chars),chars)};ss.arrayClone=function ss$arrayClone(arr){if(arr.length===1){return[arr[0]]}else{return Array.apply(null,arr)}};ss._delegateContains=function ss$_delegateContains(targets,object,method){for(var i=0;i<targets.length;i+=2){if(targets[i]===object&&targets[i+1]===method){return true}}return false};ss._mkdel=function ss$_mkdel(targets){var delegate=function(){if(targets.length==2){return targets[1].apply(targets[0],arguments)}else{var clone=ss.arrayClone(targets);for(var i=0;i<clone.length;i+=2){if(ss._delegateContains(targets,clone[i],clone[i+1])){clone[i+1].apply(clone[i],arguments)}}return null}};delegate._targets=targets;return delegate};ss.mkdel=function ss$mkdel(object,method){if(!object){return method}return ss._mkdel([object,method])};ss.delegateCombine=function ss$delegateCombine(delegate1,delegate2){if(!delegate1){if(!delegate2._targets){return ss.mkdel(null,delegate2)}return delegate2}if(!delegate2){if(!delegate1._targets){return ss.mkdel(null,delegate1)}return delegate1}var targets1=delegate1._targets?delegate1._targets:[null,delegate1];var targets2=delegate2._targets?delegate2._targets:[null,delegate2];return ss._mkdel(targets1.concat(targets2))};ss.delegateRemove=function ss$delegateRemove(delegate1,delegate2){if(!delegate1||(delegate1===delegate2)){return null}if(!delegate2){return delegate1}var targets=delegate1._targets;var object=null;var method;if(delegate2._targets){object=delegate2._targets[0];method=delegate2._targets[1]}else{method=delegate2}for(var i=0;i<targets.length;i+=2){if((targets[i]===object)&&(targets[i+1]===method)){if(targets.length==2){return null}var t=ss.arrayClone(targets);t.splice(i,2);return ss._mkdel(t)}}return delegate1};ss.delegateEquals=function ss$delegateEquals(a,b){if(a===b)return true;if(!a._targets&&!b._targets)return false;var ta=a._targets||[null,a],tb=b._targets||[null,b];if(ta.length!=tb.length)return false;for(var i=0;i<ta.length;i++){if(ta[i]!==tb[i])return false}return true};var ss_Enum=function Enum$(){};ss.Enum=ss_Enum;ss.initClass(ss_Enum,ss,{});ss_Enum.getValues=function Enum$getValues(enumType){var parts=[];var values=enumType.prototype;for(var i in values){if(values.hasOwnProperty(i))parts.push(values[i])}return parts};var ss_IEnumerator=null;var ss_IEnumerable=null;ss.getEnumerator=function ss$getEnumerator(obj){return obj.getEnumerator?obj.getEnumerator():new ss_ArrayEnumerator(obj)};ss.unbox=function ss$unbox(instance){if(!ss.isValue(instance))throw new ss_InvalidOperationException('Nullable object must have a value.');return instance};var ss_Nullable$1=function Nullable$1$(T){};ss.Nullable$1=ss_Nullable$1;ss_Nullable$1.eq=function Nullable$eq(a,b){return!ss.isValue(a)?!ss.isValue(b):(a===b)};ss_Nullable$1.ne=function Nullable$eq(a,b){return!ss.isValue(a)?ss.isValue(b):(a!==b)};ss_Nullable$1.le=function Nullable$le(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<=b};ss_Nullable$1.ge=function Nullable$ge(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>=b};ss_Nullable$1.lt=function Nullable$lt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<b};ss_Nullable$1.gt=function Nullable$gt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>b};ss_Nullable$1.sub=function Nullable$sub(a,b){return ss.isValue(a)&&ss.isValue(b)?a-b:null};ss_Nullable$1.add=function Nullable$add(a,b){return ss.isValue(a)&&ss.isValue(b)?a+b:null};ss_Nullable$1.mod=function Nullable$mod(a,b){return ss.isValue(a)&&ss.isValue(b)?a%b:null};ss_Nullable$1.div=function Nullable$divf(a,b){return ss.isValue(a)&&ss.isValue(b)?a/b:null};ss_Nullable$1.mul=function Nullable$mul(a,b){return ss.isValue(a)&&ss.isValue(b)?a*b:null};ss_Nullable$1.band=function Nullable$band(a,b){return ss.isValue(a)&&ss.isValue(b)?a&b:null};ss_Nullable$1.bor=function Nullable$bor(a,b){return ss.isValue(a)&&ss.isValue(b)?a|b:null};ss_Nullable$1.xor=function Nullable$xor(a,b){return ss.isValue(a)&&ss.isValue(b)?a^b:null};ss_Nullable$1.shl=function Nullable$shl(a,b){return ss.isValue(a)&&ss.isValue(b)?a<<b:null};ss_Nullable$1.srs=function Nullable$srs(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>b:null};ss_Nullable$1.sru=function Nullable$sru(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>>b:null};ss_Nullable$1.and=function Nullable$and(a,b){if(a===true&&b===true)return true;else if(a===false||b===false)return false;else return null};ss_Nullable$1.or=function Nullable$or(a,b){if(a===true||b===true)return true;else if(a===false&&b===false)return false;else return null};ss_Nullable$1.not=function Nullable$not(a){return ss.isValue(a)?!a:null};ss_Nullable$1.neg=function Nullable$neg(a){return ss.isValue(a)?-a:null};ss_Nullable$1.pos=function Nullable$pos(a){return ss.isValue(a)?+a:null};ss_Nullable$1.cpl=function Nullable$cpl(a){return ss.isValue(a)?~a:null};ss_Nullable$1.lift=function Nullable$lift(){for(var i=0;i<arguments.length;i++){if(!ss.isValue(arguments[i]))return null}return arguments[0].apply(null,Array.prototype.slice.call(arguments,1))};var ss_Int32=function Int32$(){};ss.Int32=ss_Int32;ss.initClass(ss_Int32,ss,{},Object,[ss_IEquatable,ss_IComparable,ss_IFormattable]);ss_Int32.getDefaultValue=ss_Int32.createInstance=function Int32$getDefaultValue(){return 0};ss_Int32.div=function Int32$div(a,b){if(!ss.isValue(a)||!ss.isValue(b))return null;if(b===0)throw new ss_DivideByZeroException;return ss_Int32.trunc(a/b)};ss_Int32.trunc=function Int32$trunc(n){return ss.isValue(n)?(n>0?Math.floor(n):Math.ceil(n)):null};var ss_JsDate=function JsDate$(){};ss_JsDate.__typeName='ss.JsDate';ss.JsDate=ss_JsDate;ss.initClass(ss_JsDate,ss,{},Object,[ss_IEquatable,ss_IComparable]);ss_JsDate.createInstance=function JsDate$createInstance(){return new Date};ss_JsDate.isInstanceOfType=function JsDate$isInstanceOfType(instance){return instance instanceof Date};var ss_ArrayEnumerator=function ArrayEnumerator$(array){this._array=array;this._index=-1};ss.ArrayEnumerator=ss_ArrayEnumerator;ss.initClass(ss_ArrayEnumerator,ss,{moveNext:function ArrayEnumerator$moveNext(){this._index++;return(this._index<this._array.length)},reset:function ArrayEnumerator$reset(){this._index=-1},current:function ArrayEnumerator$current(){if(this._index<0||this._index>=this._array.length)throw'Invalid operation';return this._array[this._index]},dispose:function ArrayEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);var ss_ObjectEnumerator=function ObjectEnumerator$(o){this._keys=Object.keys(o);this._index=-1;this._object=o};ss.ObjectEnumerator=ss_ObjectEnumerator;ss.initClass(ss_ObjectEnumerator,ss,{moveNext:function ObjectEnumerator$moveNext(){this._index++;return(this._index<this._keys.length)},reset:function ObjectEnumerator$reset(){this._index=-1},current:function ObjectEnumerator$current(){if(this._index<0||this._index>=this._keys.length)throw new ss_InvalidOperationException('Invalid operation');var k=this._keys[this._index];return{key:k,value:this._object[k]}},dispose:function ObjectEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);var ss_IDisposable=null;var ss_StringBuilder=function StringBuilder$(s){this._parts=(ss.isValue(s)&&s!='')?[s]:[];this.length=ss.isValue(s)?s.length:0};ss.StringBuilder=ss_StringBuilder;ss.initClass(ss_StringBuilder,ss,{append:function StringBuilder$append(o){if(ss.isValue(o)){var s=o.toString();this._parts.push(s);this.length+=s.length}return this},appendChar:function StringBuilder$appendChar(c){return this.append(String.fromCharCode(c))},appendLine:function StringBuilder$appendLine(s){this.append(s);this.append('\r\n');return this},appendLineChar:function StringBuilder$appendLineChar(c){return this.appendLine(String.fromCharCode(c))},clear:function StringBuilder$clear(){this._parts=[];this.length=0},toString:function StringBuilder$toString(){return this._parts.join('')}});var ss_Exception=function Exception$(message,innerException){this._message=message||'An error occurred.';this._innerException=innerException||null;this._error=new Error};ss.Exception=ss_Exception;ss.initClass(ss_Exception,ss,{get_message:function Exception$get_message(){return this._message},get_innerException:function Exception$get_innerException(){return this._innerException},get_stack:function Exception$get_stack(){return this._error.stack},toString:function Exception$toString(){var message=this._message;var exception=this;if(ss.isNullOrEmptyString(message)){if(ss.isValue(ss.getInstanceType(exception))&&ss.isValue(ss.getTypeFullName(ss.getInstanceType(exception)))){message=ss.getTypeFullName(ss.getInstanceType(exception))}else{message='[object Exception]'}}return message}});ss_Exception.wrap=function Exception$wrap(o){if(ss.isInstanceOfType(o,ss_Exception)){return o}else if(o instanceof TypeError){return new ss_NullReferenceException(o.message,new ss_JsErrorException(o))}else if(o instanceof RangeError){return new ss_ArgumentOutOfRangeException(null,o.message,new ss_JsErrorException(o))}else if(o instanceof Error){return new ss_JsErrorException(o)}else{return new ss_Exception(o.toString())}};var ss_NotImplementedException=function NotImplementedException$(message,innerException){ss_Exception.call(this,message||'The method or operation is not implemented.',innerException)};ss_NotImplementedException.__typeName='ss.NotImplementedException';ss.NotImplementedException=ss_NotImplementedException;ss.initClass(ss_NotImplementedException,ss,{},ss_Exception);var ss_NotSupportedException=function NotSupportedException$(message,innerException){ss_Exception.call(this,message||'Specified method is not supported.',innerException)};ss_NotSupportedException.__typeName='ss.NotSupportedException';ss.NotSupportedException=ss_NotSupportedException;ss.initClass(ss_NotSupportedException,ss,{},ss_Exception);var ss_AggregateException=function AggregateException$(message,innerExceptions){this.innerExceptions=ss.isValue(innerExceptions)?ss.arrayFromEnumerable(innerExceptions):[];ss_Exception.call(this,message||'One or more errors occurred.',this.innerExceptions.length?this.innerExceptions[0]:null)};ss_AggregateException.__typeName='ss.AggregateException';ss.AggregateException=ss_AggregateException;ss.initClass(ss_AggregateException,ss,{flatten:function AggregateException$flatten(){var inner=[];for(var i=0;i<this.innerExceptions.length;i++){var e=this.innerExceptions[i];if(ss.isInstanceOfType(e,ss_AggregateException)){inner.push.apply(inner,e.flatten().innerExceptions)}else{inner.push(e)}}return new ss_AggregateException(this._message,inner)}},ss_Exception);var ss_PromiseException=function PromiseException(args,message,innerException){ss_Exception.call(this,message||(args.length&&args[0]?args[0].toString():'An error occurred'),innerException);this.arguments=ss.arrayClone(args)};ss_PromiseException.__typeName='ss.PromiseException';ss.PromiseException=ss_PromiseException;ss.initClass(ss_PromiseException,ss,{get_arguments:function PromiseException$get_arguments(){return this._arguments}},ss_Exception);var ss_JsErrorException=function JsErrorException$(error,message,innerException){ss_Exception.call(this,message||error.message,innerException);this.error=error};ss_JsErrorException.__typeName='ss.JsErrorException';ss.JsErrorException=ss_JsErrorException;ss.initClass(ss_JsErrorException,ss,{get_stack:function Exception$get_stack(){return this.error.stack}},ss_Exception);var ss_ArgumentException=function ArgumentException$(message,paramName,innerException){ss_Exception.call(this,message||'Value does not fall within the expected range.',innerException);this.paramName=paramName||null};ss_ArgumentException.__typeName='ss.ArgumentException';ss.ArgumentException=ss_ArgumentException;ss.initClass(ss_ArgumentException,ss,{},ss_Exception);var ss_ArgumentNullException=function ArgumentNullException$(paramName,message,innerException){if(!message){message='Value cannot be null.';if(paramName)message+='\nParameter name: '+paramName}ss_ArgumentException.call(this,message,paramName,innerException)};ss_ArgumentNullException.__typeName='ss.ArgumentNullException';ss.ArgumentNullException=ss_ArgumentNullException;ss.initClass(ss_ArgumentNullException,ss,{},ss_ArgumentException);var ss_ArgumentOutOfRangeException=function ArgumentOutOfRangeException$(paramName,message,innerException,actualValue){if(!message){message='Value is out of range.';if(paramName)message+='\nParameter name: '+paramName}ss_ArgumentException.call(this,message,paramName,innerException);this.actualValue=actualValue||null};ss_ArgumentOutOfRangeException.__typeName='ss.ArgumentOutOfRangeException';ss.ArgumentOutOfRangeException=ss_ArgumentOutOfRangeException;ss.initClass(ss_ArgumentOutOfRangeException,ss,{},ss_ArgumentException);var ss_FormatException=function FormatException$(message,innerException){ss_Exception.call(this,message||'Invalid format.',innerException)};ss_FormatException.__typeName='ss.FormatException';ss.FormatException=ss_FormatException;ss.initClass(ss_FormatException,ss,{},ss_Exception);var ss_DivideByZeroException=function DivideByZeroException$(message,innerException){ss_Exception.call(this,message||'Division by 0.',innerException)};ss_DivideByZeroException.__typeName='ss.DivideByZeroException';ss.DivideByZeroException=ss_DivideByZeroException;ss.initClass(ss_DivideByZeroException,ss,{},ss_Exception);var ss_InvalidCastException=function InvalidCastException$(message,innerException){ss_Exception.call(this,message||'The cast is not valid.',innerException)};ss_InvalidCastException.__typeName='ss.InvalidCastException';ss.InvalidCastException=ss_InvalidCastException;ss.initClass(ss_InvalidCastException,ss,{},ss_Exception);var ss_InvalidOperationException=function InvalidOperationException$(message,innerException){ss_Exception.call(this,message||'Operation is not valid due to the current state of the object.',innerException)};ss_InvalidOperationException.__typeName='ss.InvalidOperationException';ss.InvalidOperationException=ss_InvalidOperationException;ss.initClass(ss_InvalidOperationException,ss,{},ss_Exception);var ss_NullReferenceException=function NullReferenceException$(message,innerException){ss_Exception.call(this,message||'Object is null.',innerException)};ss_NullReferenceException.__typeName='ss.NullReferenceException';ss.NullReferenceException=ss_NullReferenceException;ss.initClass(ss_NullReferenceException,ss,{},ss_Exception);var ss_KeyNotFoundException=function KeyNotFoundException$(message,innerException){ss_Exception.call(this,message||'Key not found.',innerException)};ss_KeyNotFoundException.__typeName='ss.KeyNotFoundException';ss.KeyNotFoundException=ss_KeyNotFoundException;ss.initClass(ss_KeyNotFoundException,ss,{},ss_Exception);var ss_AmbiguousMatchException=function AmbiguousMatchException$(message,innerException){ss_Exception.call(this,message||'Ambiguous match.',innerException)};ss_AmbiguousMatchException.__typeName='ss.AmbiguousMatchException';ss.AmbiguousMatchException=ss_AmbiguousMatchException;ss.initClass(ss_AmbiguousMatchException,ss,{},ss_Exception);if(typeof(global.HTMLElement)==='undefined'){global.HTMLElement=Element}if(typeof(global.MessageEvent)==='undefined'){global.MessageEvent=Event}Date.now=Date.now||function(){return+new Date};global.ss=ss})(global);
/*! BEGIN Bootstrap */
(function(){'dont use strict';var a={};global.tab=global.tab||{};global.tabBootstrap=global.tabBootstrap||{};ss.initAssembly(a,'ViewerBootstrap');var b=function(e,x,y,z){this.$1$1=null;this.$1$2=null;this.$1$3=null;this.$1$4=null;this.set_name(e);this.set_commandId(x);this.set_hostId(y);this.set_parameters(z)};b.__typeName='tab._ApiCommand';b.generateNextCommandId=function(){var e='cmd'+b.$0;b.$0++;return e};b.parse=function(e){var x;var y=e.indexOf(String.fromCharCode(44));if(y<0){x=e;return new b(x,null,null,null)}x=e.substr(0,y);var z;var A=e.substr(y+1);y=A.indexOf(String.fromCharCode(44));if(y<0){z=A;return new b(x,z,null,null)}z=A.substr(0,y);var B;var C=A.substr(y+1);y=C.indexOf(String.fromCharCode(44));if(y<0){B=C;return new b(x,z,B,null)}B=C.substr(0,y);var D=C.substr(y+1);return new b(x,z,B,D)};global.tab._ApiCommand=b;var c=function(e,x,y){this.$1=null;this.$2=null;this.$0=null;this.$1=e;this.$2=x;this.$0=y};c.__typeName='tab._ApiServerNotification';c.deserialize=function(e){var x=JSON.parse(e);var y=x['api.workbookName'];var z=x['api.worksheetName'];var A=x['api.commandData'];return new c(y,z,A)};global.tab._ApiServerNotification=c;var d=function(e){this.$1=null;this.$0=null;var x=JSON.parse(e);this.$1=x['api.commandResult'];this.$0=x['api.commandData']};d.__typeName='tab._ApiServerResultParser';global.tab._ApiServerResultParser=d;var f=function(){};f.__typeName='tabBootstrap.$0';f.$0=function(){var e={parseOnLoad:true,usePlainJson:true,noFirebugLite:true,useXDomain:tsConfig.xdomain_active,locale:'en-us'};if(tsConfig.xdomain_active){var x={tableau:tsConfig.external_static_asset_prefix+'/javascripts/built-dojo/tableau'};e.modulePaths=x;e.baseUrl=tsConfig.external_static_asset_prefix+'/vizql/';e.dojoBlankHtmlUrl=tsConfig.local_static_asset_prefix+'/javascripts/blank.html'}if(tsConfig.debugMode){try{var y=new RegExp('[?&][:]?debug=');if(window.location.search.search(y)!==-1){e.isDebug=true;e.debugAtAllCosts=true}}catch(z){}}window.self['djConfig']=e};var g=function(){};g.__typeName='tabBootstrap.$1';g.$1=function(e){var x=document.getElementById(e);if(ss.isValue(x)){x.style.display='none'}};g.$2=function(){var e=document.getElementById('tsConfigContainer');var x=JSON.parse(e.value);window.self['tsConfig']=x};g.$0=function(e){var x=document.getElementById('tabBootErr');var y=x.childNodes[1].lastChild;y.textContent+='\n'+e;x.style.display='block';g.$1('loadingGlassPane');g.$1('loadingSpinner');try{window.parent.postMessage('tableau.completed','*')}catch(z){}return false};var h=function(){q.call(this,-1,0,'',{});this.open=false;this.start=0;this.end=0};h.__typeName='tabBootstrap.$2';h.$0=function(){if(ss.isNullOrUndefined(h.$1)){h.$1=new h}return h.$1};var i=function(){};i.__typeName='tabBootstrap.$3';var j=function(){};j.__typeName='tabBootstrap.ApiCommandResponder';j.$0=function(e,x,y){var z={};z['api.workbookName']=e;z['api.worksheetName']=x;z['api.commandData']=y;return JSON.stringify(z)};global.tabBootstrap.ApiCommandResponder=j;var k=function(){j.call(this)};k.__typeName='tabBootstrap.ApiCrossDomainResponder';global.tabBootstrap.ApiCrossDomainResponder=k;var l=function(e){this.$2$1=null;j.call(this);this.set_responseAction(e)};l.__typeName='tabBootstrap.ApiNativeHostResponder';global.tabBootstrap.ApiNativeHostResponder=l;var m=function(){};m.__typeName='tabBootstrap.BaseUrlFormatter';m.formatBaseUrl=function(){return window.location.protocol+'//'+window.location.host};m.formatUrlRoot=function(e,x){var y=e;if(ss.isValue(x)){y+=x}else if(ss.isValue(tsConfig.vizql_root)){y+=tsConfig.vizql_root}else{var z=window.location.pathname;z=z.replace(new RegExp('\\/[^\\/]*$'),'');y+=z}return y};m.formatSessionMethod=function(e,x,y){var z=new ss.StringBuilder;z.append(y);z.append('/');z.append(e);z.append('/sessions/');z.append(x);return z.toString()};global.tabBootstrap.BaseUrlFormatter=m;var n=function(e,x){this.$0=null;this.$1=null;this.$0=e;var y=m.formatBaseUrl();this.$1=m.formatUrlRoot(y,x)};n.__typeName='tabBootstrap.BootstrapSession';global.tabBootstrap.BootstrapSession=n;var o=function(){};o.__typeName='tabBootstrap.EmbedMode';global.tabBootstrap.EmbedMode=o;var p=function(){};p.__typeName='tabBootstrap.Metric';p.isEqual=function(e,x){return e.w===x.w&&e.h===x.h};p.isInstanceOfType=function(){return true};global.tabBootstrap.Metric=p;var q=function(e,x,y,z){this.id=0;this.metricSuite=0;this.description=null;this.$0=null;this.start=0;this.end=0;this.open=false;this.id=e;this.metricSuite=x;this.description=y;this.start=r.getTiming();this.open=true;this.$0=z};q.__typeName='tabBootstrap.MetricsContext';global.tabBootstrap.MetricsContext=q;var r=function(){this.$8=0;this.$3=[];this.$4=[];this.$5=null;this.$9='';this.$b='';this.$a='';this.$6='';this.$7=0;if(ss.isValue(tsConfig.metricsFilter)&&tsConfig.metricsFilter!==''){var e=0;var x=tsConfig.metricsFilter.split(String.fromCharCode(124));for(var y=0;y<x.length;y++){var z=x[y];var A=((typeof(z['trim'])==='function')?z.trim():z);A=A.toLowerCase();if(ss.keyExists(r.$3,A)){e|=r.$3[A]}}this.$7=e}};r.__typeName='tabBootstrap.MetricsController';r.$1=function(){if(ss.isNullOrUndefined(r.$4)){r.$4=new r}return r.$4};r.createContext=function(e,x,y){if(ss.isNullOrUndefined(x)){x=32}var z=x===0||(x&r.$1().$7)!==x;if(ss.isNullOrUndefined(y)){y={}}var A;if(z){A=h.$0()}else{A=new q(r.$1().$0(),x,e,y);r.$1().$3.push(A)}return A};r.logEvent=function(e){if(e.metricSuite===0||(e.metricSuite&r.$1().$7)!==e.metricSuite){return}if(ss.isValue(r.$1().$5)){e.parameters['sid']=r.$1().$6;r.$1().$5(e)}else{r.$1().$4.push(e)}};r.setEventLogger=function(e){r.$1().$5=e;if(ss.isValue(e)&&r.$4.$4.length>0){for(var x=0;x<r.$4.$4.length;x++){var y=r.$4.$4[x];y.parameters['sid']=r.$4.$6;r.$4.$5(y)}r.$4.$4=[]}};r.initSessionInfo=function(){var e=r.$1();var x=(ss.isNullOrEmptyString(tsConfig.current_sheet_name)?tsConfig.sheetId:tsConfig.current_sheet_name);if(ss.referenceEquals(e.$9,tsConfig.sessionid)&&ss.referenceEquals(e.$b,tsConfig.workbookName)&&ss.referenceEquals(e.$a,x)){return}e.$9=tsConfig.sessionid;e.$b=tsConfig.workbookName;e.$a=x;var y=new Date;e.$6=y.getTime().toString(36);e.$6=e.$6.substr(e.$6.length-6);if(e.$9.length>=5){e.$6=e.$6+e.$9.substr(1,1);e.$6=e.$6+e.$9.substr(4,1)}e.$2()};r.closeContext=function(e){var x=e.id;var y=-1;for(var z=r.$1().$3.length-1;z>=0;z--){if(r.$4.$3[z].id===x){y=z;break}}if(y!==-1){var A=r.$4.$3.length-y;for(var B=0;B<A;B++){r.$4.$3.pop()}}r.$4.$1(e)};r.$0=function(e){var x={};x['id']=e.id;x['d']=e.description;if(ss.getKeyCount(e.get_properties())>0){x['p']=e.get_properties()}return x};global.tabBootstrap.MetricsController=r;var s=function(e,x,y){this.eventType=null;this.metricSuite=0;this.parameters=null;this.eventType=e;this.metricSuite=x;this.parameters=y};s.__typeName='tabBootstrap.MetricsEvent';global.tabBootstrap.MetricsEvent=s;var t=function(){};t.__typeName='tabBootstrap.MetricsSuites';global.tabBootstrap.MetricsSuites=t;var u=function(){};u.__typeName='tabBootstrap.Utility';u.$c=function(){if(!tsConfig.is_mobile_device||tsConfig.embedded){return false}var e=window.navigator.userAgent.indexOf('Android')!==-1;if(e){return false}var x=window.navigator.userAgent.indexOf('Safari')!==-1&&window.navigator.userAgent.indexOf('OS 7')!==-1;return x};u.$b=function(){try{var e=u.$4();var x=e.orientation;return ss.isValue(x)&&(x===90||x===-90)}catch(y){}return false};u.get_urlLocationSearchParams=function(){return u.$a(u.get_urlLocationSearch().substring(1))};u.get_urlLocationHashData=function(){var e={};var x=u.get_urlLocationHash();if(x.length<2){return{}}x=x.substr(1);var y=x.split('&');for(var z=0;z<y.length;z++){var A=y[z];var B=A.split('=');if(B.length===1){e[u.CLIENTNO]=B[0]}else if(B.length===2){var C=decodeURIComponent(B[0]);var D=decodeURIComponent(B[1]);e[C]=D}}return e};u.set_urlLocationHashData=function(e){var x=new ss.StringBuilder;var y=true;var z=function(){x.append((y?'#':'&'));y=false};var A=new ss.ObjectEnumerator(e);try{while(A.moveNext()){var B=A.current();var C=encodeURIComponent(B.key);z();if(ss.referenceEquals(C,u.CLIENTNO)){x.append(B.value)}else if(ss.isNullOrUndefined(B.value)){x.append(C)}else{x.append(C).append('=').append(encodeURIComponent(B.value))}}}finally{A.dispose()}if(ss.isValue(x)){var D=u.get_locationWindow();if(u.historyApiSupported()){u.replaceState(D,null,null,x.toString())}else{D.location.hash=x.toString()}}};u.get_urlLocationHash=function(){var e=u.get_locationWindow();return e.location.hash};u.get_urlLocationSearch=function(){var e=u.get_locationWindow();return e.location.search};u.get_embedMode=function(){return u.$d};u.get_locationWindow=function(){return window.self};u.$a=function(e){var x={};var y=e.split('&');for(var z=0;z<y.length;z++){var A=y[z];var B=A.split('=');if(B.length===2){var C=decodeURIComponent(B[0]);var D=decodeURIComponent(B[1]);x[C]=D}}return x};u.xhrPostJsonChunked=function(x,y,z,A,B,C){var D=new XMLHttpRequest;D.open('POST',x,C);D.setRequestHeader('Accept','text/javascript');D.setRequestHeader('Content-Type','application/x-www-form-urlencoded');if(!ss.isNullOrUndefined(tsConfig.sheetId)){D.setRequestHeader('X-Tsi-Active-Tab',tsConfig.sheetId)}var E=u.$2(D,B);var F=0;var G=function(){var e='';try{e=D.responseText}catch(T){}var K=e.length;while(F<K){var L=e.substr(F);var M=new RegExp('^(\\d+);');var N=L.match(M);if(!ss.isValue(N)){return}var O=N[0].length;var P=parseInt(N[1]);if(O+P>L.length){return}L=L.substr(O,P);var Q=null;try{var R='Parse '+((F===0)?'Primary':'Secondary')+' JSON';{var S=r.createContext(R,32,null);try{Q=u.$9(L)}finally{if(ss.isValue(S)){S.dispose()}}}}catch(T){E(new ss.Exception('Invalid JSON'))}if(F===0){z(Q)}else{A(Q)}F+=O+P}};var H=-1;var I=false;var J=window.navigator.userAgent.indexOf('MSIE')>=0&&parseFloat(window.navigator.appVersion.split('MSIE ')[1])<10;D.onreadystatechange=function(){try{if(!J&&D.readyState===3&&D.status===200&&!I){G();if(H===-1){H=window.setInterval(G,10)}I=true;return}if(D.readyState!==4){return}if(H!==-1){window.clearInterval(H);H=-1}if(u.$8(D)){G()}else{E(new ss.Exception('Unable to load '+x+'; status: '+D.status))}}catch(e){var ex=ss.Exception.wrap(e);if(typeof(ss.getType('ss'))==='undefined'){D.abort()}else{throw ex}}};try{D.send(y)}catch(K){var e=ss.Exception.wrap(K);E(e)}};u.xhrGetXmlSynchronous=function(x,y){var z=new XMLHttpRequest;z.open('GET',x,false);z.setRequestHeader('Accept','text/xml');try{z.send()}catch(A){var e=ss.Exception.wrap(A);u.$7(z,y,e);return null}return z.responseText};u.xhrPostJson=function(y,z,A,B,C){var D=new XMLHttpRequest;D.open('POST',y,C);D.setRequestHeader('Accept','text/javascript');D.setRequestHeader('Content-Type','application/x-www-form-urlencoded');if(ss.isValue(tsConfig.sheetId)){D.setRequestHeader('X-Tsi-Active-Tab',tsConfig.sheetId)}var E=u.$2(D,B);D.onreadystatechange=function(){if(D.readyState!==4){return}if(u.$8(D)){try{var e=u.$9(D.responseText);A(e)}catch(F){var x=ss.Exception.wrap(F);E(x)}}else{E(new ss.Exception('Unable to load '+y+'; status: '+D.status))}};try{D.send(z)}catch(F){var e=ss.Exception.wrap(F);E(e)}};u.applySafari7CSSHackFix=function(){if(u.$c()){if(u.$b()){window.document.body.style.height=window.outerHeight-20+'px'}else{window.document.body.style.height=''}}};u.attachOneTimeMessageHandler=function(e){var x=null;x=function(y){var z=y;if(e(z)){if(ss.isValue(window.self.removeEventListener)){window.removeEventListener('message',x,false)}else{window.self.detachEvent('onmessage',x)}}};if(ss.isValue(window.self.addEventListener)){window.addEventListener('message',x,false)}else{window.self.attachEvent('onmessage',x)}};u.doPostMessageWithContext=function(e){var x=false;if(tsConfig.loadOrderID>=0){e+=','+tsConfig.loadOrderID}if(!ss.isNullOrEmptyString(tsConfig.apiID)){if(tsConfig.loadOrderID<0){e+=','+tsConfig.loadOrderID}e+=','+tsConfig.apiID}x=u.doPostMessage(e);return x};u.doPostMessage=function(e){var x=false;if('postMessage'in window){try{window.parent.postMessage(e,'*');x=true}catch(y){}}return x};u.$0=function(){var e=false;try{e=ss.referenceEquals(window.self,window.parent)}catch(x){}if(e){return'notEmbedded'}return'embedded'};u.$9=function(e){if(ss.isNullOrUndefined(e)||typeof(e)!=='string'){return null}e=e.trim();var x=JSON.parse(e);return x};u.$5=function(){var e=window.document.documentElement;return{w:e.clientWidth,h:e.clientHeight}};u.$6=function(){return{w:window.innerWidth,h:window.innerHeight}};u.$4=function(){var e=window.self;while(ss.isValue(e.parent)&&!ss.referenceEquals(e.parent,e)){e=e.parent}return e};u.$3=function(){var e,x;var y=window.document.documentElement.clientWidth;var z=window.document.documentElement.clientHeight;var A=window.navigator.userAgent.indexOf('Android')!==-1;if(A){if(y===window.screen.height){x=window.screen.width-z;e=y-x;y=z+x;z=e}}else if(u.$b()){if(window.innerHeight<z&&u.$c()){z-=20}if(y===window.screen.width){x=window.screen.height-z;e=y-x;y=z+x;z=e}}else if(y===window.screen.height){x=window.screen.width-z;e=y-x;y=z+x;z=e}return{w:y,h:z}};u.get_hashClientNumber=function(){var e=u.get_urlLocationHashData();return((ss.isValue(e)&&ss.isValue(e[u.CLIENTNO]))?e[u.CLIENTNO]:'')};u.addToUrlHash=function(e,x){var y=u.get_urlLocationHashData();y[e]=x;u.set_urlLocationHashData(y)};u.historyApiSupported=function(){return typeof(window.history['pushState'])==='function'&&typeof(window.history['replaceState'])==='function'};u.replaceState=function(e,x,y,z){try{e.history.replaceState(x,y,z)}catch(A){}};u.getValueFromUrlHash=function(e){var x=u.get_urlLocationHashData();return(ss.keyExists(x,e)?x[e]:'')};u.removeEntryFromUrlHash=function(e){var x=u.get_urlLocationHashData();delete x[e];u.set_urlLocationHashData(x)};u.$1=function(){var e=1;if(ss.isValue(tsConfig.highDpi)&&tsConfig.highDpi){if(ss.isValue(tsConfig.pixelRatio)){e=tsConfig.pixelRatio}else{e=ss.coalesce(window.self['devicePixelRatio'],1)}}return e};u.$8=function(e){var x=(ss.isValue(e.status)?e.status:0);if(x>=200&&x<300||x===304||x===1223||x===0&&(window.location.protocol==='file:'||window.location.protocol==='chrome:')){return true}return false};u.$7=function(e,x,y){if(ss.staticEquals(x,null)){return}var z=u.$2(e,x);z(y)};u.$2=function(e,x){return function(y){y.status=e.status;y.responseText=e.responseText;x(y)}};global.tabBootstrap.Utility=u;var v=function(e){this.location=null;this.toolbarDisplayed=false;this.rid=0;this.ts=0;this.isVisibleRectCommunicationEnabled=false;this.apiResponder=null;this.$4=null;this.$6=null;this.$5=null;this.authoringLeftAreaWidth=0;this.rightAreaDrawerWidth=0;this.clearSessionOnUnload=false;this.initialLayoutModel=null;this.initialLayoutError=null;this.secondaryResponses=null;this.bootstrapState=1;this._onSuccess=null;this._onError=null;this.$7=false;this.authoringGutter=null;if(!tsConfig.isPublic&&!tsConfig.toolbarvis){tsConfig.blogURI='';tsConfig.downloadURI=''}this.toolbarDisplayed=tsConfig.toolbarContainerVis;this.ts=(new Date).getTime();this.rid=0;this.location=window.location;tsConfig.showLytebox=ss.referenceEquals(window.self,window.top)&&!ss.isNullOrEmptyString(tsConfig.primaryContentUrl)&&!tsConfig.is_authoring;this.apiResponder=e||v.$0();u.applySafari7CSSHackFix();this.setupClearSessionOnBrowserUnload();this.$7=false;this.authoringLeftAreaWidth=((tsConfig.is_authoring&&!tsConfig.is_mobile)?200:0);if(u.get_embedMode()==='embedded'){u.attachOneTimeMessageHandler(ss.mkdel(this,function(x){if(x.data==='tableau.enableVisibleRectCommunication'){this.isVisibleRectCommunicationEnabled=true;return true}return false}));u.doPostMessageWithContext('tableau.listening')}this.authoringGutter={top:0,left:6,bottom:6,right:15}};v.__typeName='tabBootstrap.ViewerBootstrap';v.get_instance=function(){return v._instance=v._instance||new v(v.$0())};v.get_canvasPixelLimit=function(){var e=25000000;if(ss.isValue(tsConfig.is_mobile)&&tsConfig.is_mobile){e=3000000}return e};v.resetInstance=function(){v._instance=null};v.makeOneTimeListener=function(e){var x=false;return function(y){if(x){return}x=true;e(y)}};v.makeOneTimeHandler=function(e){var x=false;return function(){if(x){return}x=true;e(null)}};v.$0=function(){if(tsConfig.is_mobile_app){return new l(null)}else{return new k}};global.tabBootstrap.ViewerBootstrap=v;var w=function(){};w.__typeName='tabBootstrap.VizLayoutConstants';w.get_vizToolbarHeight=function(){return((tsConfig.isPublic&&!tsConfig.features['UsePublicSpecificToolbar']&&tsConfig.watermarkdisplay||tsConfig.is_mobile_app)?60:27)};w.get_displayToolbarHeight=function(){return(v.get_instance().toolbarDisplayed?w.get_vizToolbarHeight():0)};w.get_shouldShowTabs=function(){return tsConfig.showTabs};w.get_tabsHeight=function(){if(tsConfig.is_authoring){return 0}return(w.get_shouldShowTabs()?23:0)};w.get_authoringToolbarHeight=function(){if(!tsConfig.is_authoring){return 0}return(tsConfig.is_mobile?44:40)};w.get_authoringMastheadHeight=function(){if(!tsConfig.is_authoring||!tsConfig.features['WebAuthoringMenuBar']&&tsConfig.is_mobile_app){return 0}else if(tsConfig.features['WebAuthoringMenuBar']){return(tsConfig.is_mobile_app?44:60)}else{return(tsConfig.is_mobile?32:50)}};w.get_authoringTabsHeight=function(){return(tsConfig.is_authoring?30:0)};w.get_authoringVizBorderWidth=function(){return(tsConfig.is_authoring?1:0)};w.get_authoringShelfWidth=function(){return(tsConfig.is_authoring?(tsConfig.is_mobile?50:190):0)};w.get_authoringShelfHeight=function(){return(tsConfig.is_authoring?(tsConfig.is_mobile?0:68):0)};w.get_authoringVizMargin=function(){return(tsConfig.is_authoring?6:0)};global.tabBootstrap.VizLayoutConstants=w;ss.initClass(b,a,{get_name:function(){return this.$1$1},set_name:function(e){this.$1$1=e},get_hostId:function(){return this.$1$2},set_hostId:function(e){this.$1$2=e},get_commandId:function(){return this.$1$3},set_commandId:function(e){this.$1$3=e},get_parameters:function(){return this.$1$4},set_parameters:function(e){this.$1$4=e},get_isApiCommandName:function(){return this.get_rawName().indexOf('api.',0)===0},get_rawName:function(){return this.get_name().toString()},serialize:function(){var e=[];e.push(this.get_name());e.push(this.get_commandId());e.push(this.get_hostId());if(ss.isValue(this.get_parameters())){e.push(this.get_parameters())}var x=e.join(',');return x}});ss.initClass(c,a,{get_workbookName:function(){return this.$1},get_worksheetName:function(){return this.$2},get_data:function(){return this.$0},serialize:function(){var e={};e['api.workbookName']=this.$1;e['api.worksheetName']=this.$2;e['api.commandData']=this.$0;return JSON.stringify(e)}});ss.initClass(d,a,{get_result:function(){return this.$1},get_data:function(){return this.$0}});ss.initClass(f,a,{});ss.initClass(g,a,{});ss.initClass(q,a,{get_endTime:function(){return this.end},get_properties:function(){return this.$0},dispose:function(){this.close()},close:function(){if(this.open){this.end=r.getTiming();r.closeContext(this);this.open=false}},elapsedMS:function(){if(!this.open){return this.end-this.start}return r.getTiming()-this.start}},null,[ss.IDisposable]);ss.initClass(h,a,{close:function(){}},q,[ss.IDisposable]);ss.initEnum(i,a,{$4:1,$3:2,$2:3,$1:4,$0:5});ss.initClass(j,a,{sendResponse:null,sendEventNotification:function(e,x,y){var z=j.$0(tsConfig.workbookName,ss.coalesce(x,''),ss.coalesce(y,''));var A=new b(e,'xdomainSourceId',tsConfig.apiID,z);this.sendResponse(A,z)}});ss.initClass(k,a,{$0:function(){return!ss.referenceEquals(window.window,window.parent)},sendResponse:function(e,x){if(!('postMessage'in window)||!this.$0()){return}var y=e.get_name();var z=new b(y,e.get_commandId(),e.get_hostId(),x);var A=z.serialize();window.parent.postMessage(A,'*')}},j);ss.initClass(l,a,{get_responseAction:function(){return this.$2$1},set_responseAction:function(e){this.$2$1=e},sendResponse:function(e,x){if(!ss.staticEquals(this.get_responseAction(),null)){this.get_responseAction()(e,x)}}},j);ss.initClass(m,a,{});ss.initClass(n,a,{formatSessionMethod:function(e){return m.formatSessionMethod(e,this.$0,this.$1)}});ss.initEnum(o,a,{notEmbedded:'notEmbedded',embedded:'embedded'},true);ss.initClass(p,a,{},Object);ss.initClass(r,a,{$0:function(){var e=this.$8;++this.$8;return e},$2:function(){var e={};e['id']=this.$9;e['sid']=this.$6;e['wb']=this.$b;e['s']=this.$a;e['m']=tsConfig.is_mobile;r.logEvent(new s('init',2,e))},$1:function(e){var x=r.$0(e);x['t']=e.get_endTime();x['e']=e.elapsedMS();r.logEvent(new s('wp',e.metricSuite,x))}});ss.initClass(s,a,{});ss.initEnum(t,a,{none:0,navigation:1,bootstrap:2,rendering:4,commands:8,hitTest:16,debug:32,toolbar:64,fonts:128,min:3,core:15,all:255});ss.initClass(u,a,{});ss.initClass(v,a,{get_hasBootstrapCompleted:function(){return this.bootstrapState===4||this.bootstrapState===5},get_hasBootstrapSucceeded:function(){return this.bootstrapState===4},get_hasBootstrapFailed:function(){return this.bootstrapState===5},get_authoringLeftAreaWidth:function(){return this.authoringLeftAreaWidth},set_authoringLeftAreaWidth:function(e){this.authoringLeftAreaWidth=e},get_rightAreaDrawerWidth:function(){return this.rightAreaDrawerWidth},set_rightAreaDrawerWidth:function(e){this.rightAreaDrawerWidth=e},get_sessionBeingCleared:function(){return this.$7},get_clientDimension:function(){if(ss.isValue(this.$4)){return this.$4}var e=u.get_urlLocationSearchParams()[':size'];var x=(ss.isValue(e)?e.split(String.fromCharCode(44)).map(function(y){return parseInt(y)}):null);this.$4=((ss.isNullOrUndefined(x)||isNaN(x[0])||isNaN(x[1]))?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:x[0],h:x[1]});return this.$4},get_deviceType:function(){return this.$6},get_compositeSize:function(){if(ss.isValue(this.$5)){return this.$5}this.$5=this.getCompositeSizeForDeviceType(this.get_deviceType());return this.$5},getCompositeSizeForDeviceType:function(e){var x=JSON.parse(tsConfig.composite_sizes);return x[v.$2[e]]},setupClearSessionOnBrowserUnload:function(){this.clearSessionOnUnload=tsConfig.clear_session_on_unload;if(!this.clearSessionOnUnload){return}if(ss.isValue(window.self['addEventListener'])){window.addEventListener('beforeunload',ss.mkdel(this,function(){this.$7=true;this.clearSession()}),false)}else if(ss.isValue(window.self['attachEvent'])){window.attachEvent('onbeforeunload',ss.mkdel(this,function(){this.$7=true;this.clearSession()}))}},disableClearSessionOnBrowserUnload:function(){this.clearSessionOnUnload=false},waitOnInitialLayoutModel:function(e,x,y){if(this.get_hasBootstrapCompleted()){x(null);return}if(this.bootstrapState!==3){this._onSuccess=e;this._onError=x;this['_onSecondary']=y}else{this._onError=x;this['_onSecondary']=y;var z=this.initialLayoutModel;var A=this.initialLayoutError;if(ss.isValue(A)||ss.isNullOrUndefined(z)){this.bootstrapState=5;x(A)}else{e(z);this.bootstrapState=4;if(ss.isValue(y)&&ss.isValue(this.secondaryResponses)){for(var B=0;B<this.secondaryResponses.length;B++){y(this.secondaryResponses[B])}}}}},$3:function(){var e=null;e=ss.mkdel(this,function(x){var y=x;if(y.data==='tableau.bootstrap'){this.$2();if(ss.isValue(window.self.removeEventListener)){window.removeEventListener('message',e,false)}else{window.self.detachEvent('onmessage',e)}}});if(ss.isValue(window.self.addEventListener)){window.addEventListener('message',e,false)}else{window.self.attachEvent('onmessage',e)}},bootstrap:function(){this.$0();if(!tsConfig.bootstrapWhenNotified||u.get_embedMode()==='notEmbedded'){this.$2()}else{this.$3()}this.$1()},$0:function(){var e=u.get_urlLocationSearchParams()[':device'];if(!ss.isNullOrEmptyString(e)){var x=ss.getEnumerator(Object.keys(v.$2));try{while(x.moveNext()){var y=x.current();if(ss.referenceEquals(v.$2[y],e)){this.$6=y;return}}}finally{x.dispose()}}var z=Math.min(this.get_clientDimension().w,this.get_clientDimension().h);this.$6=((z<=tsConfig.dsd_phone_max_size)?'phone':((z<=tsConfig.dsd_tablet_max_size)?'tablet':'desktop'))},$2:function(){this.rid++;var e=document.getElementById('staticImage');if(tsConfig.bootstrapOnMouseover){this.scaleImageToFit(e)}var x=[];var y=this.getWebClientPortSize('worksheet');x.push('worksheetPortSize='+encodeURIComponent(JSON.stringify(y)));y=this.getWebClientPortSize('dashboard');x.push('dashboardPortSize='+encodeURIComponent(JSON.stringify(y)));if(!tsConfig.is_authoring){x.push('clientDimension='+encodeURIComponent(JSON.stringify(this.get_clientDimension())))}tsConfig.is_rendering_enabled=tsConfig.is_browser_rendering_requested;x.push('isBrowserRendering='+tsConfig.is_rendering_enabled);x.push('browserRenderingThreshold='+tsConfig.browser_rendering_threshold);x.push('formatDataValueLocally='+tsConfig.formatDataValueLocally);x.push('clientNum='+encodeURIComponent(u.get_hashClientNumber()));var z=u.$1();x.push('devicePixelRatio='+encodeURIComponent(z.toString()));if(ss.isValue(tsConfig.is_mobile)&&tsConfig.is_mobile){x.push('imageSizeLimit='+encodeURIComponent((5242880).toString()));x.push('transparentLineMarkLimit='+1200)}x.push('clientRenderPixelLimit='+encodeURIComponent(v.get_canvasPixelLimit().toString()));if(!ss.isNullOrEmptyString(tsConfig.deviceTypeOverride)){x.push(':device='+tsConfig.deviceTypeOverride)}if(ss.isValue(tsConfig.sheetId)){x.push('sheet_id='+encodeURIComponent(tsConfig.sheetId.toString()))}if(ss.isValue(tsConfig.showParams)){x.push('showParams='+encodeURIComponent(tsConfig.showParams.toString()))}if(ss.isValue(tsConfig.stickySessionKey)){x.push('stickySessionKey='+encodeURIComponent(tsConfig.stickySessionKey))}if(ss.isValue(tsConfig.filterTileSize)){x.push('filterTileSize='+encodeURIComponent(tsConfig.filterTileSize.toString()))}if(ss.isValue(tsConfig.workbookLocale)){x.push('workbookLocale='+encodeURIComponent(tsConfig.workbookLocale))}if(ss.isValue(tsConfig.locale)){x.push('locale='+encodeURIComponent(tsConfig.locale.toString()))}if(ss.isValue(tsConfig.language)){x.push('language='+encodeURIComponent(tsConfig.language.toString()))}if(ss.isValue(tsConfig.syncSession)&&tsConfig.syncSession.length!==0&&typeof(tsConfig.syncSession)==='string'){x.push('sync_session_state='+encodeURIComponent(this.getSyncSessionState(tsConfig.syncSession)))}if(ss.isValue(tsConfig.debugMode)){x.push('verboseMode='+tsConfig.debugMode)}if(ss.isValue(tsConfig.features_json)){x.push(':session_feature_flags='+encodeURIComponent(tsConfig.features_json.toString()))}if(ss.isValue(tsConfig.keychain_version)){x.push('keychain_version='+tsConfig.keychain_version)}var A=x.join('&');var B=new n(tsConfig.sessionid);var C=B.formatSessionMethod('bootstrapSession');var D=this.rid;var E=r.createContext('BTSTRP'.toString(),2,null);var F=this;var G=ss.mkdel(this,function(M){E.dispose();M.rid=D;if(ss.isValue(this._onSuccess)){this._onSuccess(M);this.bootstrapState=4}else{this.bootstrapState=3}this.markInitialLayoutModelAsFinished(M,null)});var H=function(M){if('_onSecondary'in F){F['_onSecondary'](M)}else{F.appendSecondaryResponse(M)}};var I=ss.mkdel(this,function(M){if(ss.isValue(this._onError)){this.bootstrapState=5;this._onError(M)}else{this.bootstrapState=3}this.markInitialLayoutModelAsFinished(null,M);E.dispose()});var J=ss.mkdel(this,function(){this.bootstrapState=2;if(ss.isNullOrUndefined(tsConfig.offlineBootstrapResponse)){u.xhrPostJsonChunked(C,A,G,H,I,true)}else{if(tsConfig.offlineBootstrapResponse.length===0){throw new ss.Exception('Offline bootstrap response is empty')}G(JSON.parse(tsConfig.offlineBootstrapResponse[0]));for(var M=1;M<tsConfig.offlineBootstrapResponse.length;M++){H(JSON.parse(tsConfig.offlineBootstrapResponse[M]))}}});if(!tsConfig.bootstrapOnMouseover){J();return}var K=document.getElementById('initializing_thin_client');this.hideLoadIndicators(K,e);var L=ss.mkdel(this,function(){this.showLoadIndicators(K,e);J()});if(ss.isValue(e)){if(ss.isValue(e.addEventListener)){e.addEventListener('mouseover',v.makeOneTimeListener(L),false)}else if(ss.isValue(e.attachEvent)){e.attachEvent('onmouseover',v.makeOneTimeHandler(L))}}},showLyteboxIfNeeded:function(){if(tsConfig.showLytebox){document.getElementById('primaryContent').style.display='block';document.getElementById('primaryContentLink').style.display='';document.getElementById('centeringContainer').className='lyteboxed';document.getElementById('lyteboxClose').style.display='block';document.body.className+=' lyteboxed'}},getViewport:function(){if(tsConfig.is_mobile_device&&!tsConfig.embedded){return u.$3()}return((tsConfig.features['IframeSizedToWindow']&&!tsConfig.is_mobile)?u.$6():u.$5())},$1:function(){var e=new Object;e.maxHeight=this.get_compositeSize().maxHeight;e.maxWidth=this.get_compositeSize().maxWidth;e.minHeight=this.get_compositeSize().minHeight;e.minWidth=this.get_compositeSize().minWidth;var x=e;var y=new Object;y.sizeConstraints=x;y.chromeHeight=this.chromeMetricsForViewingOnly().h;var z=y;this.apiResponder.sendEventNotification('api.FirstVizSizeKnownEvent',null,JSON.stringify(z))},getSyncSessionState:function(e){var x=e.split(String.fromCharCode(47));var y=new n(x[1],'/'+x[0]);var z=y.formatSessionMethod('get_global_filters');return u.xhrGetXmlSynchronous(z,null)},getWebClientDashboardContainerSize:function(e){var x=this.getViewport();var y=this.chromeMetrics(e);x.h-=y.h;x.w-=y.w;return this.adjustForMinMaxDashboardSizes(x)},getVizClientContainerSize:function(e){var x=this.getWebClientDashboardContainerSize(e);x.h+=w.get_tabsHeight()+w.get_displayToolbarHeight();return x},getWebClientPortSize:function(e){var x=this.getWebClientDashboardContainerSize(e);if(e==='dashboard'&&ss.isValue(tsConfig.features)&&tsConfig.is_authoring){x.h-=this.authoringGutter.top+this.authoringGutter.bottom;x.w-=this.authoringGutter.left+this.authoringGutter.right}return this.adjustForMinMaxDashboardSizes(x)},adjustForMinMaxDashboardSizes:function(e){var x=this.get_compositeSize().minWidth;var y=this.get_compositeSize().maxWidth;if(x!==0&&e.w<x){e.w=x}else if(y!==0&&e.w>y){e.w=y}else if(tsConfig.showLytebox){e.w=tsConfig.lyteboxedVizWidth}var z=this.get_compositeSize().minHeight;if(z!==0&&e.h<z){e.h=z}else{var A=this.get_compositeSize().maxHeight;if(A!==0&&e.h>A){e.h=A}}return e},chromeMetrics:function(e){var x=0;var y=0;if(this.toolbarDisplayed){x+=w.get_vizToolbarHeight()}x+=w.get_authoringToolbarHeight();x+=w.get_authoringMastheadHeight();x+=w.get_authoringTabsHeight();x+=w.get_tabsHeight();if(!tsConfig.is_mobile){x+=2*w.get_authoringVizBorderWidth();y+=2*w.get_authoringVizBorderWidth()}if(e==='worksheet'){x+=w.get_authoringShelfHeight();y+=w.get_authoringShelfWidth();y+=this.get_authoringLeftAreaWidth();if(!tsConfig.is_mobile){x+=w.get_authoringVizMargin();y+=w.get_authoringVizMargin()}}else if(e==='dashboard'||e==='story'){y+=this.get_authoringLeftAreaWidth()}y+=this.get_rightAreaDrawerWidth();return{w:y,h:x}},getWebClientContentSizeForViewingOnly:function(){var e=this.getViewport();var x=this.chromeMetricsForViewingOnly();e.h-=x.h;e.w-=x.w;return this.adjustForMinMaxDashboardSizes(e)},chromeMetricsForViewingOnly:function(){var e=0;if(this.toolbarDisplayed){e+=w.get_vizToolbarHeight()}e+=w.get_tabsHeight();return{w:0,h:e}},showLoadIndicators:function(e,x){if(ss.isValue(e)){e.style.display='block'}if(ss.isValue(x)){x.style.cursor='wait'}},hideLoadIndicators:function(e,x){if(!ss.isNullOrUndefined(e)){e.style.display='none'}if(!ss.isNullOrUndefined(x)){x.style.cursor='default'}},clearSession:function(){if(!this.clearSessionOnUnload){return}var e=(new n(tsConfig.sessionid)).formatSessionMethod('clear');var x=function(){};u.xhrPostJson(e,null,x,x,false)},markInitialLayoutModelAsFinished:function(e,x){this.initialLayoutError=x;this.initialLayoutModel=e;delete this['_onSuccess']},appendSecondaryResponse:function(e){if(ss.isValue(this.secondaryResponses)){this.secondaryResponses.push(e)}else{this.secondaryResponses=[e]}},scaleImageToFit:function(e){var x=e.style.backgroundImage.replace(new RegExp('"','g'),'').replace(new RegExp('url\\((.*)\\)','gi'),'$1');var y=document.createElement('img');var z=ss.mkdel(this,function(){var B=this.getWebClientContentSizeForViewingOnly();var C=this.chromeMetricsForViewingOnly();var D={w:B.w+C.w-parseInt(e.style.left,10),h:B.h+C.h-parseInt(e.style.top,10)};if(ss.Int32.div(D.h,y.height)<ss.Int32.div(D.w,y.width)){var E=Math.round(D.h*y.width/y.height);e.style.backgroundSize=E+'px '+D.h+'px'}else{var F=Math.round(D.w*y.height/y.width);e.style.backgroundSize=D.w+'px '+F+'px'}});if(ss.isValue(y.addEventListener)){y.addEventListener('load',z,false)}else if(ss.isValue(y.attachEvent)){y.attachEvent('onload',function(){z(null)})}else{y.onload=z}var A=function(){tsConfig.bootstrapOnMouseover=false;if(ss.isNullOrUndefined(e)){return}if(ss.isValue(e.dispatchEvent)){var B=document.createEvent('MouseEvents');B.initMouseEvent('mouseover',true,true,window.self,null,0,0,0,0,false,false,false,false,null,null);e.dispatchEvent(B)}else if(ss.isValue(e['fireEvent'])){e['fireEvent']('onmouseover')}};if(ss.isValue(y['addEventListener'])){y.addEventListener('error',A,false)}else if(ss.isValue(y['attachEvent'])){y.attachEvent('onerror',function(){A(null)})}else{y['onerror']=A}y.src=x}});ss.initClass(w,a,{});ss.setMetadata(t,{enumFlags:true});(function(){b.crossDomainEventNotificationId='xdomainSourceId';b.$0=0})();(function(){f.$1='en-us'})();(function(){window.onerror=ss.delegateCombine(window.onerror,function(e,x,y,z,A){return g.$0(e)});g.$2();f.$0()})();(function(){h.$1=null})();(function(){r.getTiming=null;r.recordingStart=0;r.$2=0;r.$3=null;r.$4=null;r.recordingStart=(new Date).getTime();if(ss.isValue(window)&&ss.isValue(window.self.performance)&&ss.isValue(window.self.performance['now'])){if(ss.isValue(window.self.performance.timing)){r.$2=window.self.performance.timing.responseStart-window.self.performance.timing.navigationStart}else{r.$2=0}r.getTiming=function(){return window.self.performance.now()-r.$2}}else{r.$2=(new Date).getTime();r.getTiming=function(){return(new Date).getTime()-r.$2}}r.$3={};r.$3['none']=0;r.$3['navigation']=1;r.$3['bootstrap']=2;r.$3['rendering']=4;r.$3['commands']=8;r.$3['toolbar']=64;r.$3['hittest']=16;r.$3['debug']=32;r.$3['fonts']=128;r.$3['min']=3;r.$3['core']=15;r.$3['all']=255})();(function(){u.$e=20;u.$d=null;u.CLIENTNO='cn';u.$d=u.$0()})();(function(){v.ipadImageSizeLimit=5242880;v.$1=1200;v.$2=ss.mkdict(['phone','phone','tablet','tablet','desktop','desktop','default','default']);v._instance=null})();(function(){w.toolbarHeight=27;w.largeToolbarHeight=60;w.tabsHeightPx=23;w.$0=60;w.$1=44})()})();var viewerBootstrap=tabBootstrap.ViewerBootstrap.get_instance();viewerBootstrap.bootstrap();viewerBootstrap.showLyteboxIfNeeded()})();